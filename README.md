你好，这是我在中国科学技术大学大一新生“科学与社会”研讨课所完成的项目：以MNIST数字集训练卷积神经网络，并结合opencv连结电脑摄像头实现对画面中手写数字的识别。

作为本人第一个github项目，可以发现，我甚至将MNIST数字集打成了MINIST数字集。如果日后我的Github仓丰富起来，那么这个小小的失误将作为我科研生涯从小白到入门的最好见证。

整体上这个项目还不成熟，也非常非常简单，但却是我迈出的第一步，让我这个目前的编程小白意识到，自己也可以学会学懂当下最“热”话题--人工智能。

简单介绍一下代码： 

1、MNIST 训练卷积神经 
定义卷积神经结构如下，经两个卷积层（conv），一个池化层（pool）， 25%的dropout、两个全连接层和一个ReLU层，属于较为经典的卷积神经结构：

<img width="569" height="139" alt="image" src="https://github.com/user-attachments/assets/3af7f4ea-fa70-4dcf-89eb-4eeb818073a0" />


训练函数定义：先加载数据及对应标签（data, target），再将data模型输入model加载出output，将output和target比对得到损失(loss)，loss反向传播、计算梯度，再在优化器（本代码中选择Adam优化器）中根据设定步长调节参数，每100个batch打
印一批相关参数。  

测试函数定义：将data、target加载回device（本实验选用CPU，也可以用GPU）计算output，再使用argmax方法求得output张量对应的预测值也即pred（本实验中，pred 是数字0-9），将其与target比对后，用sum函数求和从而得到正确预测结果总
数correct，从而得到并打印准确率accuracy。

现在进行5个epoch，每个epoch皆由上述训练函数和测试函数组成，如果测试函数
输出accuracy 为最高准确率则将model保存到”best_model.pth”，并打印相应提示。 
此外，在最初设置神经网络参数时是随机设置的，使得每次训练出的model准确率都
有差异，因此手动固定所有随机种子为42，最终每次训练准确率皆为99.14%。 
2、测试卷积神经效果 
图像预处理：定义preprocess程序，将黑底白字的照片转化为28x28像素的灰度图， 
从而将左图转化成MNIST风格的数字以供神经网络识别。 
结果测试：通过定义predict函数（主要思路与2.1中定义的测试函数类似，将预处理
过的图像输入到model得到pred，并且呈现），结果如下，说明单次实验展现出该卷
积神经效果较好。 

3、 利用OpenCV对拍摄内容进行实时数字识别 
如图所示，定义predict_from_camera()函数，通过 OpenCV 捕获摄像头画面，实时处
理并显示预测结果，同样先对图像进行了颜色反转处理（白底黑字→黑底白字）以匹
配 MNIST 数据集格式，再进行结果的预测与显示。同时在原来摄像头无法退出的问
题基础上，新增退出代码段，以支持按Q或ESC退出功能 
预测正确时的效果如下，画面由电脑前置摄像头实时拍摄，左上绿字为预测出的数
字： 
不过，相比2.2中的测试效果，结同摄像头的预测准确值有显著下降，推测是由于真
实环境噪声较大，真实案例中前辈们有加入降噪程序，本项目中没有采用导致结果偏
差明显。另一个是，有时候即便画面中并没有出现数字，程序还是会有“推测结果”的显
示，这个是因为当时设计整个项目的时候没有把这点考虑进去，其实可以给预测流程
追加“未识别到文字”选项，但这个还有待后续有时间继续研究。
